%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 	   美赛模板，正文部分		 
%          PAPER.tex         
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[11pt]{article}

% 请在此填写控制号、题号和标题，年份不需要填（自动以当前电脑时间年份为准）
\usepackage[1923231]{easymcm}\problem{C}   
\usepackage{palatino} % 这个是COMAP官方杂志采用的字体，如不需要可注释掉，以使用默认字体
\usepackage{subfigure}
\usepackage{float}
\captionsetup[figure]{font=scriptsize}
\title{\large God or evil? A ... model analysing and predicting opioid use}  % 标题
\setlength\parindent{0pt} %default no indent
\newcommand{\upcite}[1]{\textsuperscript{\textsuperscript{\cite{#1}}}}
% 如您参加的是ICM（即选择了D/E/F题），请使用以下的命令修改Summary Sheet题头
% \renewcommand{\contest}{Interdisciplinary Contest in Modeling (ICM) Summary Sheet}

% 正文开始
\begin{document}
\input{ABSTRACT.tex}		% 摘要请到ABSTRACT.tex中填写

\section*{Memo}
\newpage

\section{Introduction}
\subsection{Problem Background}
Opioids, no matter synthetic ones or non-synthetic ones, play an significant role in our daily life. The proper utilization of opioids helps thousands of people get relieved from their pains. However, misuse of them can really destroy the society. Therefore, it is essential and urgent to gain a better understanding of opioids' spread and influencing factors.

Recent years have witnessed the tremendous growth of opioids cases. How this trend will develop remains an national concern. With data of annual drug use and socio-economic factors in five U.S. states over the past few years, we perform data mining and construct a model to figure out the pattern of opioids use and what contributes to it.

% \subsection{Literature Review}
% A literatrue\upcite{1} say something about this problem ...

\subsection{Our work}
We do such things ...

\begin{enumerate}[\bfseries 1.]
    \item We do ...
    \item We do ...
    \item We do ...
\end{enumerate}

\section{Assumptions and Nomenclature}
\subsection{Assumptions}
Given the lack of data and limitation of our knowledge, we made the following assumption:
\begin{itemize}
    \item We assume that the data after processing is robust for futher use.
\end{itemize}

\subsection{Notations}
The primary notations used in this paper are listed in \textbf{Table \ref{tb:notation}}.
\begin{table}[!htbp]
\begin{center}
\caption{Notations}
\begin{tabular}{cl}
	\toprule
	\multicolumn{1}{m{3cm}}{\centering Symbol}
	&\multicolumn{1}{m{8cm}}{\centering Definition}\\
	\midrule
	$A$&the first one\\
	$b$&the second one\\
	$\alpha$ &the last one\\
	\bottomrule
\end{tabular}\label{tb:notation}
\end{center}
\end{table}

\section{Data Processing}
We are provided with two types of data, the number of drug reports in categories and socio-economic factors. Both of them are specific to counties. The original data contains a lot of redundant and invalid items, which can seriously affect the accuracy and versatility of our model. Thereby, we first apply some data processing techniques before we construct the model.
\subsection{Missing Data Processing}
% In US, each county is assigned a unique five-digit code called FIPS county code. 
In the worksheet about socio-economic factors, there are many cells that contain no valid information at all. We delete columns and rows which contains a lot of useless cells. For other columns and rows, when invalid items appear, we replace it with the average value of the entire sequence.

\subsection{Clustering Counties of Five States}
Since we have detailed number of drug reports, it is not hard to fit a curve to observe the trend of opioid use for each state and for each county. However, we consider this method inappropriate. On the one hand, the sample for only one county is normally fluctuating irregularly, i.e. drug reports of heroin in ACCOMACK, VA was 2, 38, 6 during 2012-2014. It is unnecessary and meaningless to bulid a model when facing such fluctuation. On the other hand, given the large number of all kinds of opioids, even one type change significantly, it is not obvious when viewed as the level of the whole state.

% \begin{figure}[htbp]
% \centering        %居中
% \subfigure[name of the subfigure]{ %第一张子图
% 	\begin{minipage}{7cm}\centering   %子图居中
% 		\includegraphics[scale=0.5]{./figures/1.png}  %以pic.jpg的0.5倍大小输出
% 	\end{minipage}}
% \subfigure[name of the subfigure]{ %第二张子图
% 	\begin{minipage}{7cm}\centering %子图居中
% 		\includegraphics[scale=0.3]{./figures/2.png}  %以pic.jpg的0.5倍大小输出
% 	\end{minipage}}
% \caption{name of the figure} %%大图名称
% \label{fig:1} %图片引用标记
% \end{figure}

Considering that state and county are not suitable for our research, a unit in between is introduced. We put counties on a two-dimensional plane and regard them as nodes. Then, k-means clustering method\upcite{1}, which aims to partion nodes into k clusters minimizing the within-cluster sum of squares, was performed. In our case, we take $k = 10$. The distance of two counties can be computed with their latitude and longtitude retrieved from U.S. Census Bureau\upcite{2}. %TODO: Add cluster figure

\subsection{Combine variables of a Socio-economic Factor}
For every year from 2010 to 2016, there are a list of variables about one single socio-economic factor. For instance, factor ANCERSTRY includes estimate, estimate margin of error, percent, etc. Those variables all reflect some information of the target factor in some aspects, hence how to rank their importance matters. 

In information theory, entropy represents the information a sequence contains\upcite{3}. So Entropy Weight Method (EWM), which gives each index a weight according to their entropy, is chosen to measure the significance of each index. Before that, we normalize the data given using the following equation.
\begin{equation}
	y_{i} = \frac{x_{i}-min(x_{i})}{max(x_{i}) - min(x_{i})}
\end{equation}
where $x_{i}$ and $y_{i}$ denotes the original sequence and processed sequence.

We apply EWM in the way addressed as follows (Using ANCERSTRY as an example):
\begin{itemize}
	\item Define Estimate, Estimate margin of error, Percent, Percent margin of error of ANCERSTRY is defined as $y_{j}$ ($y_{1}$ means Estimate...). Compute entropy for $y_{j}$: $ E_{j} = -\frac{\sum p_{i}lnp_{i}}{ln(n)}$, where $p_{i}=\frac{y_{ji}}{\sum_{i} y_{ji}}$, $E_{j}$ represents the entropy for each index.
	\item Compute weight for Estimate, Estimate margin of error, Percent, Percent margin of error of ANCERSTRY: $ W_{j} = \frac{E_{j}}{\sum E_{j}}$, where $W_{j}$ represents the weight for each index.
	\item Combine variables using the weight: $y'_{i} = \sum_{j} W_{j} * y_{ji}$
\end{itemize}
So far, we have combined several variables of a factor into one $y'_{i}$, and the same can be done to other factors. The newly generated sequence will be reserved for further analysis.

\section{Model Construction}
\subsection{Logistic Model to Identify Locations}
\subsubsection{Data Screening}
In order to solve the problem in Part 1 and describe the dissemination and characteristics of the synthetic opioids and heroin events over time, which are reported between five states and counties, we need to screen the information in MCM\_NFLIS\_Data.xlsx. By consulting Wikipedia, DrugBank and other websites, provided drugs are roughly classified into synthetic opioids, semi-synthetic opioids, and natural ingredients. In view of the topic requirements, we excluded the natural ingredients and drugs other than heroin in semi-synthetic opioids, leaving the drug reports of heroin and synthetic opioids only. As for the synthetic opioid drug reports, we find that many drugs have been used in small amounts over the years compared to those used in large numbers by using the function of screen and statistic of the EXCEL. Even some drugs are new, which have appeared in the past two years, so we can almost ignore them for there’s hardly any help. Finally, we leave about 15 kinds of synthetic drugs that have appeared since 2010 for model research.

\subsubsection{Model Establishment}
With the K-means cluster analysis, we acquire data about the synthetic opioid and heroin events in ten clusters. It is known that the drug use levels in most areas are increasing. Considering that these data will not grow endlessly over time, it will bring about the corresponding effects mentioned in the topic introduction when a certain threshold is exceeded, resulting in a series of social problems. Therefore, government’s relevant departments, including the Drug Enforcement Administration(DEA), will take corresponding measures to control the growth trend of drug use. When consumptions are too high (N(t) is relatively large), however the rate of change in usage will reduce. when drug-use levels are low, the rate of change is gradually increasing.

The regular pattern is consistent with the Logistic model of population growth. In that model, the natural growth rate of the population will be limited by the population. Similarly, the drug-use level will be limited by the government’s allowable upper limit. Assuming that the government can come up with effective controlling measures according to the drug-use level, it can be considered that the growth trend of synthetic opioid and heroin events are subordinated to the Logistic model. Here’s the Logistic growth model:
% \begin{equation}
\begin{gather}
	\frac{dN(t)}{dt} = r(1-\frac{N(t)}{K})N(t) \\
	N(t_{0}) = N_{0}
\end{gather}

where 'N(t)' represents the drug-use amount at some time, 'K' represents the upper limit of the drug-use level, which is allowed in an area. The 'r' is an influence factor of the drug-us amount. The model can be understood that there is no strict control and the drug is attractive in the early time, which results in the quickly increase of the drug use. As some departments begin to pay attention to this phenomenon and implement policies to control it, the growth rate of drug use begins to decrease. When the drug-use level is close to the allowable upper limit, $\frac{(1-Q)}{K} \approx 0$ . At this point, the drug-use level will no longer increase. Considering the discretization of the model and data, $\frac{dN(t)}{dt}$ is the increasing amount between two years.

For the solution of the logistic model, the following formula is given.
\begin{gather}
	N(t)=\frac{K}{1+Ce^(-r(t-t_{0}))} \\
	C=\frac{K-N_{0}}{N_{0}} 
\end{gather}

The above mathematical formulas and model could be established by programing. We bring the data of ten clusters into the model and acquire the logistic regressing curves.

\subsubsection{Model Application and Solving Problems}
In order to test the effectiveness of our model, we first put the total drug reports into the model for regressing and fitting, and get the following results. From the above clusters mentioned, the drug-use level in some areas is decreasing or fluctuating, we find three unsuitable clusters(cluster 4, cluster 5, cluster 10) and the following figure can show that those data are not suitable in this model. Therefore we cannot use the Logistic population growth model to perform regression of these areas’ drug reports. That is to say, other models may be needed for prediction to them, which is not considered here.

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.6]{./figures/1.png}
	\caption{Total Drug Reports Curves of Unsuitable Clusters}
\end{figure}

According to fitted curves of those suitable data, we obtain the curves of drug-use level for 20years from 2000 to the present and find intersections of every curve and the time axis. Here’s the figure following, which describe most clusters’ characteristics of total drug use.
\begin{figure}[H]
	\centering
	\includegraphics[scale=0.6]{./figures/2.png}
	\caption{Total Drug Reports Curves of Suitable Clusters}
\end{figure}

We can clearly see that cluster 2, where drug cases have started since 1999, is earlier than other six clusters and this is exactly our target to find in specific opioids in most clusters.

Therefore, we make use of this model to analyze the usage of heroin and synthetic opioids screened in data screening and acquire the following results.

\begin{figure}[H]
	\centering %图片全局居中
	%并排几个图，就要写几个minipage
	\begin{minipage}[b]{0.45\textwidth} %所有minipage宽度之和要小于1，否则会自动变成竖排
	\centering %图片局部居中
	\includegraphics[scale=0.5]{./figures/3.png} %此时的图片宽度比例是相对于这个minipage的，不是全局
	\caption{Drug Reports for Heroin}
	\label{Fig.1}
	\end{minipage}
	\begin{minipage}[b]{0.45\textwidth} %所有minipage宽度之和要小于1，否则会自动变成竖排
	\centering %图片局部居中
	\includegraphics[scale=0.5]{./figures/4.png}%此时的图片宽度比例是相对于这个minipage的，不是全局
	\caption{Drug Reports for Syntheic Opioids}
	\label{Fig.2}
	\end{minipage}
\end{figure}

As we can see from the above figure, the cluster 8 in the ten clusters has already started using heroin drugs before 2000. It can be considered that the area which cluster 8 represents could be the location where heroin started to appear and use.

In this figure, it can be seen that cluster 1, 3, 7, 8, and 9 all started using drugs in the vicinity of 2001. Because the time accuracy is not particularly precise, they may all be the areas where synthetic opioids were used earlier. According to our model, we believe that the XXX represented by cluster 3 is the area where the synthetic opioids use have started earlier, and the other XXX represented by other clusters(1,7,8 and 9) may also be areas that have already been used.

\section{Strengths and Weaknesses}
\subsection{Strengths}
\begin{itemize}
    \item Our model takes the idea of clustering, which overcomes the difficulty of analysing either the whole state or one single county.
    \item We take several measures to process the dataset and make it convenient for use, while the authenticity and integrity of data is still maintained.
\end{itemize}

\subsection{Weaknesses}
\begin{itemize}
    \item Nothing yet
 \end{itemize}

\begin{thebibliography}{99}
\addcontentsline{toc}{section}{References}  %引用部分标题（"Refenrence"）的重命名
\bibitem{1}MacQueen, J. (1967, June). Some methods for classification and analysis of multivariate observations. In Proceedings of the fifth Berkeley symposium on mathematical statistics and probability (Vol. 1, No. 14, pp. 281-297).
\bibitem{2}Gazetteer Files - Geography - U.S. Census Bureau. \texttt{\\https://www.census.gov/geo/maps-data/data/gazetteer.html}
\bibitem{3}Shannon, C. E. (1948). A mathematical theory of communication. Bell system technical journal, 27(3), 379-423.
\bibitem{4}DrugBank. \texttt{https://www.drugbank.ca/drug}
\end{thebibliography}


% ==============以下为附录内容，如您的论文中不需要程序附录请自行删除====================
\clearpage
\begin{subappendices}						% 附录环境
\section*{Apendix: The Source Codes}		% 附录标题可以自行修改
\addcontentsline{toc}{section}{Appendix}  	% 将附录内容加入到目录中

This python program implements k-means clustering.
\lstinputlisting[language={python}, caption=\texttt{k-means.py}]{../code/k-means.py}
% \inputpython{../code/k-means.py}{0}{68}

This MATLAB program is used to calculate the value of variable $a$.
\begin{lstlisting}[language={Matlab}, caption=\texttt{temp.m}]
a = 0;
for i = 1:5
	a = a + 1;
end
\end{lstlisting}

This LINGO program is used to search the optimize solution of 0-1 problem.
\begin{lstlisting}[language=Lingo, caption=\texttt{temp.lg4}]
model:
sets:
WP/1..12/: M, W, X;
endsets
data:
M = 2 5 18 3 2 5 10 4 11 7 14 6;
W = 5 10 13 4 3 11 13 10 8 16 7 4;
enddata
max = @sum(WP:W*X);
@sum(WP: M * X)<=46;
@for(WP: @bin(X));
end
\end{lstlisting}

\textbf{\textcolor[rgb]{0.98,0.00,0.00}{Input matlab source:}}
% \lstinputlisting[language=Matlab]{../code/matlab-test.m}

\end{subappendices}
% =================================================================================



\end{document}